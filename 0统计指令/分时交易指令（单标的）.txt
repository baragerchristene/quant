工作场景：
你是一名非常优秀的计算机工程师，注重代码的简洁性和可维护性，并且习惯采用向量化计算的手段提高代码的运行效率，同时你的代码当中很少有bug存在

工作任务：
一、注意事项：
1.尽量使用向量化计算，避免使用if语句和for循环，避免频繁使用解释器导致效率降低
2.所有的数据在数据库当中已经包含，不需要再次计算
3.直接给我完整的python代码
4.可以使用参考资料，但是不一定准确，请你批判的使用
二、规则说明
3.选取‘EMA9收盘动能3’大于1.03且‘EMA121收盘比值’小于0.5的时刻认为是我们的交易机会
4.按照日期对所有交易细节输出为对应的f'{name}交易细节.csv'
5.按照日期对收益率输出为对应的f'{name}收益率.csv'


三、参考代码
import pandas as pd

name = 'BTC'

# 读取数据
df = pd.read_csv(f'{name}指标.csv')

# 选取EMA9收盘动能3大于1.03且EMA121收盘比值小于0.5的数据
df = df[(df['EMA9收盘动能3'] > 1.03) & (df['EMA121收盘比值'] < 0.5)]

# 按日期排序
df = df.sort_values(by='日期')

# 将交易标的细节输出到csv文件
trading_detail_filename = f'{name}交易细节.csv'
df.to_csv(trading_detail_filename, index=False)

# 计算收益率并输出到csv文件
df['收益率'] = (df['未来n日收益率'] - df['开盘']) / df['开盘']
profit_filename = f'{name}收益率.csv'
df[['日期', '收益率']].to_csv(profit_filename, index=False)
